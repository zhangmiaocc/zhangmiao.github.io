<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Android,Android Tips,">





  <link rel="alternate" href="/atom.xml" title="zm.blog" type="application/atom+xml">






<meta name="description" content="早期的Android上App的启动速度常为人诟病，如今的启动表现已不逊iOS。Google针对系统的不断优化绝对功不可没，从8.0独立出来的SplashWindow，到12上推出的全新SplashScreen。  在App的主要内容展示之前，按照需求的不同，或多或少会先展示这样几个画面。    画面 用途    Splash Screen 展示品牌Logo或Slogan   Advertisem">
<meta name="keywords" content="Android,Android Tips">
<meta property="og:type" content="article">
<meta property="og:title" content="Android12上全新的应用启动画面">
<meta property="og:url" content="https://zhangmiao.cc/posts/8c53fca7.html">
<meta property="og:site_name" content="zm.blog">
<meta property="og:description" content="早期的Android上App的启动速度常为人诟病，如今的启动表现已不逊iOS。Google针对系统的不断优化绝对功不可没，从8.0独立出来的SplashWindow，到12上推出的全新SplashScreen。  在App的主要内容展示之前，按照需求的不同，或多或少会先展示这样几个画面。    画面 用途    Splash Screen 展示品牌Logo或Slogan   Advertisem">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8140f612d4174f01b1b5791d85908ca2~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa147a6e37654221aad6b9c0e2dc6c15~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15646fcb27b44852b5cd11542b8f2273~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c97d0d1d5b80474f94035489c3a74156~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/185e7d837b7744f591f65c89242b8bcb~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/76f3d841738346e59f7572bf803f9133~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ddd239d0b1c04df18facac58f140fef6~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a334fb8b87104fde8b455d94087be1c0~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b7598d3b251e4e1bae551f435cdec373~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e6b5b723882498caa23a399b5187124~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/075b09771c974bf6bccbab4b742657de~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/43a839b5840e4d23a553db2c40fdc01e~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ffc9abaab9b416e82fe2fb69a62d165~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c17496c976754fd795c7015c265386e8~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6579c39d65d54b5bbf34949a8d21e87b~tplv-k3u1fbpfcp-zoom-1.image">
<meta property="og:updated_time" content="2021-12-24T02:05:30.001Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android12上全新的应用启动画面">
<meta name="twitter:description" content="早期的Android上App的启动速度常为人诟病，如今的启动表现已不逊iOS。Google针对系统的不断优化绝对功不可没，从8.0独立出来的SplashWindow，到12上推出的全新SplashScreen。  在App的主要内容展示之前，按照需求的不同，或多或少会先展示这样几个画面。    画面 用途    Splash Screen 展示品牌Logo或Slogan   Advertisem">
<meta name="twitter:image" content="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8140f612d4174f01b1b5791d85908ca2~tplv-k3u1fbpfcp-zoom-1.image">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://zhangmiao.cc/posts/8c53fca7.html">





  <title>Android12上全新的应用启动画面 | zm.blog</title>
  





  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?44434226ba535875b1e807122adc3a04";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">zm.blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">select * from learn</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://zhangmiao.cc/posts/8c53fca7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZhangMiao">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/4081078?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="zm.blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Android12上全新的应用启动画面</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-05-18T10:39:24+08:00">
                2021-05-18
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/Android-Tips/" itemprop="url" rel="index">
                    <span itemprop="name">Android Tips</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/posts/8c53fca7.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="posts/8c53fca7.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/posts/8c53fca7.html" class="leancloud_visitors" data-flag-title="Android12上全新的应用启动画面">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>早期的Android上App的启动速度常为人诟病，如今的启动表现已不逊iOS。Google针对系统的不断优化绝对功不可没，从8.0独立出来的<code>SplashWindow</code>，到12上推出的全新<code>SplashScreen</code>。</p>
</blockquote>
<p>在App的主要内容展示之前，按照需求的不同，或多或少会先展示这样几个画面。</p>
<table>
<thead>
<tr>
<th>画面</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>Splash Screen</td>
<td>展示品牌Logo或Slogan</td>
</tr>
<tr>
<td>Advertisement Screen</td>
<td>展示节日活动或日常广告</td>
</tr>
<tr>
<td>Guide Screen</td>
<td>演示重点功能，一般只展示一次</td>
</tr>
</tbody></table>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8140f612d4174f01b1b5791d85908ca2~tplv-k3u1fbpfcp-zoom-1.image" alt="启动过程示意图"></p>
<a id="more"></a>

<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h2><p>我们常常花费精力去打造引导画面或广告画面，而作为第一印象的启动画面却容易被忽视。回想下以前都是怎么处理这个画面的：</p>
<ol>
<li>一般通过设置<code>windowSplashscreenContent</code>属性来展示UI提供的启动图，系统将为它创建专门的Window</li>
<li>假使忘记设置这个属性的话，默认的白色背景将导致启动过程中会有个白画面一闪而过</li>
<li>要去掉这个突兀的白画面可不能简单地设置Background为null，不然一闪而过的又会变成黑画面</li>
<li>最终发现<code>windowDisablePreview</code>属性可以彻底关闭这个画面，这样一来确实没有任何突兀的画面一闪而过了</li>
</ol>
<p>但这又会带来启动”变慢”的副作用，因为用来过渡的启动画面被关闭之后，App描画前屏幕几乎没有什么变化。即便App性能没有劣化，但为了留住用户，我们还是得好好对待这个启动画面。</p>
<p>然而现有的<code>windowSplashscreenContent</code>可供定制的空间着实有限。也许官方也注意到了这点，便精心设计了<code>Splash Screen</code>  API，并在<code>Android 12</code>里重磅推出。</p>
<p>有了这个全新特性的帮助，启动画面的定制将更加自由、方便。先来看下采用SplashScreen API 快速定制的启动效果。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa147a6e37654221aad6b9c0e2dc6c15~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>下面将逐步演示全新SplashScreen可供定制的各个方面。</p>
<h2 id="2-定制进入效果"><a href="#2-定制进入效果" class="headerlink" title="2 定制进入效果"></a>2 定制进入效果</h2><p>采用xml即可快速定制各式进入效果。</p>
<h3 id="2-1-默认的启动效果"><a href="#2-1-默认的启动效果" class="headerlink" title="2.1 默认的启动效果"></a>2.1 默认的启动效果</h3><p>默认情况下启动画面将展示白色背景和Launcher上的<code>Adaptive Icon</code>，也是不错的，比以前的白画面要好很多。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15646fcb27b44852b5cd11542b8f2273~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="2-2-自定义静态Icon"><a href="#2-2-自定义静态Icon" class="headerlink" title="2.2 自定义静态Icon"></a>2.2 自定义静态Icon</h3><p>替换Icon为Adaptive Icon的前景图，背景色微调为米黄色。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowSplashScreenBackground"</span>&gt;</span>@color/newSplashScreenColor<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowSplashScreenAnimatableIcon"</span>&gt;</span>@drawable/ic_kotlin_hero_new<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c97d0d1d5b80474f94035489c3a74156~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="2-3-自定义Icon背景"><a href="#2-3-自定义Icon背景" class="headerlink" title="2.3 自定义Icon背景"></a>2.3 自定义Icon背景</h3><p>Icon色调和画面背景色的对比不够明显的情况下，可以添加Icon背景色加强辨识度。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">”android:windowSplashScreenIconBackground”</span>&gt;</span>@color/newSplashIconMaskColor<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/185e7d837b7744f591f65c89242b8bcb~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="2-4-自定义品牌Logo"><a href="#2-4-自定义品牌Logo" class="headerlink" title="2.4 自定义品牌Logo"></a>2.4 自定义品牌Logo</h3><p>添加品牌Logo可以展示企业形象或Slogan，使得启动画面更为完整和精细。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">”android:windowSplashScreenBrandingImage”</span>&gt;</span>@drawable/ic_tm_brand_newer<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/76f3d841738346e59f7572bf803f9133~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="2-5-自定义动画Icon"><a href="#2-5-自定义动画Icon" class="headerlink" title="2.5 自定义动画Icon"></a>2.5 自定义动画Icon</h3><p>动画形式的Icon可以增添设计和创意，使得启动流程更加流畅和有趣。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowSplashScreenAnimatableIcon"</span>&gt;</span>@drawable/ic_kotlin_hero_new_animated_rotate<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowSplashScreenAnimationDuration"</span>&gt;</span>@integer/icon_animator_duration<span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>比如让机器人图标旋转起来。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ddd239d0b1c04df18facac58f140fef6~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>再比如让机器人在Kotlin上侧滑。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a334fb8b87104fde8b455d94087be1c0~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>或者让几何图案拼凑出字母K之后和机器人汇合，象征着<code>Android</code>和<code>Kotlin</code>的强强联合。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b7598d3b251e4e1bae551f435cdec373~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p><strong>注意：</strong></p>
<ul>
<li>动画Icon的时长上限为<code>1000ms</code>。</li>
<li>图标的进入动画可以定制，但由系统控制，不可以被监听和额外处理。</li>
</ul>
<h3 id="2-6-延长启动画面"><a href="#2-6-延长启动画面" class="headerlink" title="2.6 延长启动画面"></a>2.6 延长启动画面</h3><blockquote>
<p>The splash screen is dismissed as soon as your app draws its first frame. If you need to load a small amount of data such as in-app theme settings from a local disk asynchronously, you can use ViewTreeObserver.OnPreDrawListener to suspend the app to draw its first frame.</p>
</blockquote>
<p>后台数据的加载难免耗时，启动画面结束了主要内容仍未加载好的话，体验不是太好。能够控制启动画面的持续时时长就好了。</p>
<p>现有的ViewTreeObserver的<code>OnPreDrawListener</code>回调是可以挂起描画的，如果我们在数据准备好之后再放行描画，就可以间接地延长启动画面的显示。</p>
<p>比如Activity初始化2s后才放行描画。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SplashActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        ...</span><br><span class="line">        keepSplashScreenLonger()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">keepSplashScreenLonger</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 监听Content View的描画时机</span></span><br><span class="line">        <span class="keyword">val</span> content: View = findViewById(android.R.id.content)</span><br><span class="line">        content.viewTreeObserver.addOnPreDrawListener(</span><br><span class="line">            <span class="keyword">object</span> : ViewTreeObserver.OnPreDrawListener &#123;</span><br><span class="line">                <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onPreDraw</span><span class="params">()</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">                    <span class="comment">// 准备好了描画放行，反之挂起</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">if</span> (viewModel.isDataReady()) &#123;</span><br><span class="line">                        content.viewTreeObserver.removeOnPreDrawListener(<span class="keyword">this</span>)</span><br><span class="line">                        <span class="literal">true</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="literal">false</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyViewModel</span></span>(application: Application): AndroidViewModel(application) &#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span> &#123;</span><br><span class="line">        const <span class="keyword">val</span> WORK_DURATION = <span class="number">2000</span>L</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> initTime = SystemClock.uptimeMillis()</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">isDataReady</span><span class="params">()</span></span> = SystemClock.uptimeMillis() - initTime &gt; WORK_DURATION</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>看一下效果，发现启动画面的展示时间确实变长了。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e6b5b723882498caa23a399b5187124~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h2 id="3-定制退出效果"><a href="#3-定制退出效果" class="headerlink" title="3 定制退出效果"></a>3 定制退出效果</h2><p>当App的第一帧开始描画，<code>SplashScreen</code>将会退出展示。为了丰富退出环节的体验，系统也开放了相应的入口，即画面退出的回调。在这个回调里可以开始退出效果的定制，包括整体的退出动画和图标的退出动画。</p>
<h3 id="3-1-监听启动画面的退出"><a href="#3-1-监听启动画面的退出" class="headerlink" title="3.1 监听启动画面的退出"></a>3.1 监听启动画面的退出</h3><p>向SplashScreen注册OnExitAnimationListener接口即可监听启动画面的退出。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    customizeSplashScreenExit()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">customizeSplashScreenExit</span><span class="params">()</span></span> &#123;</span><br><span class="line">    splashScreen.setOnExitAnimationListener &#123; splashScreenView -&gt;</span><br><span class="line">        Log.d(<span class="string">"Splash"</span>, <span class="string">"SplashScreen#onSplashScreenExit view:<span class="variable">$splashScreenView</span>"</span>)</span><br><span class="line">        sleep(<span class="number">1000</span>)</span><br><span class="line">        Log.d(<span class="string">"Splash"</span>, <span class="string">"SplashScreen#remove after sleeping"</span>)</span><br><span class="line">        splashScreenView.remove()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>可以看到启动画面展示之后，不作定制的默认情况下就是全屏一下再消失。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/075b09771c974bf6bccbab4b742657de~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>日志如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Splash  : Activity:com.example.splash.MainActivity<span class="meta">@f</span>70c0d0 Activity:com.example.splash.MainActivity<span class="meta">@f</span>70c0d0 onCreate</span><br><span class="line">Splash  : Activity:com.example.splash.MainActivity<span class="meta">@f</span>70c0d0 onStart</span><br><span class="line">Splash  : Activity:com.example.splash.MainActivity<span class="meta">@f</span>70c0d0 onResume</span><br><span class="line">Splash  : SplashScreen#onSplashScreenExit view:android.window.SplashScreenView&#123;18339d5 V.E...... ........ 0,0-1080,2280&#125;</span><br><span class="line">Splash  : SplashScreen#remove after sleeping</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><strong>一定记得调用remove及时移除启动画面，否则SplashScreen会长时间盖在主画面上，大概在5s左右。</strong></p>
<p>另外，回调的注册需要放在<code>Activity#onResume</code>前，不然监听不到。</p>
<h3 id="3-2-定制整体的退出动画"><a href="#3-2-定制整体的退出动画" class="headerlink" title="3.2 定制整体的退出动画"></a>3.2 定制整体的退出动画</h3><p>可以给启动画面的整体设置<code>TRANSLATE</code>、<code>SCALE</code>、<code>ROTATE</code>、<code>ALPHA</code>等各种动画，使得退出更加自然。</p>
<p>比如给SplashScreen加上一个缩小出屏幕的动画。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">customizeSplashScreenExit</span><span class="params">()</span></span> &#123;</span><br><span class="line">    splashScreen.setOnExitAnimationListener &#123; splashScreenView -&gt;</span><br><span class="line">        showSplashExitAnimator(splashScreenView)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showSplashExitAnimator</span><span class="params">(splashScreenView: <span class="type">SplashScreenView</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> path = Path()</span><br><span class="line">    path.moveTo(<span class="number">1.0</span>f, <span class="number">1.0</span>f)</span><br><span class="line">    path.lineTo(<span class="number">0</span>f, <span class="number">0</span>f)</span><br><span class="line">    <span class="keyword">val</span> scaleOut = ObjectAnimator.ofFloat(</span><br><span class="line">        splashScreenView,</span><br><span class="line">        View.SCALE_X,</span><br><span class="line">        View.SCALE_Y,</span><br><span class="line">        path</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    scaleOut.doOnEnd &#123;</span><br><span class="line">        splashScreenView.remove()</span><br><span class="line">    &#125;</span><br><span class="line">    scaleOut.start()</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/43a839b5840e4d23a553db2c40fdc01e~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<p>又或者从上方平移出屏幕的动画。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showSplashExitAnimator</span><span class="params">(splashScreenView: <span class="type">SplashScreenView</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> slideUp = ObjectAnimator.ofFloat(</span><br><span class="line">        splashScreenView,</span><br><span class="line">        View.TRANSLATION_Y,</span><br><span class="line">        <span class="number">0</span>f,</span><br><span class="line">        -splashScreenView.height.toFloat()</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    slideUp.start()</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ffc9abaab9b416e82fe2fb69a62d165~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="3-3-定制图标的退出动画"><a href="#3-3-定制图标的退出动画" class="headerlink" title="3.3 定制图标的退出动画"></a>3.3 定制图标的退出动画</h3><p>当然也可以给图标单独加上动画，比如将Icon上滑。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">customizeSplashScreenExit</span><span class="params">()</span></span> &#123;</span><br><span class="line">    splashScreen.setOnExitAnimationListener &#123; splashScreenView -&gt;</span><br><span class="line">        showSplashIconExitAnimator(splashScreenView)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showSplashIconExitAnimator</span><span class="params">(splashScreenView: <span class="type">SplashScreenView</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> iconView = splashScreenView.iconView ?: <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">val</span> slideUp = ObjectAnimator.ofFloat(</span><br><span class="line">        splashScreenView.iconView,</span><br><span class="line">        View.TRANSLATION_Y,</span><br><span class="line">        <span class="number">0</span>f,</span><br><span class="line">        -iconView.height * <span class="number">2.</span>toFloat()</span><br><span class="line">    )</span><br><span class="line">    ...</span><br><span class="line">    slideUp.start()</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c17496c976754fd795c7015c265386e8~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述"></p>
<h3 id="3-4-退出动画的适当时长"><a href="#3-4-退出动画的适当时长" class="headerlink" title="3.4 退出动画的适当时长"></a>3.4 退出动画的适当时长</h3><p>针对退出动画的定制官方还有一段补充说明。</p>
<blockquote>
<p>By the start of this callback, the animated vector drawable on the splash screen has begun. Depending on the duration of the app launch, the drawable might be in the middle of its animation. Use <code>SplashScreenView.getIconAnimationStart</code> to know when the animation started. You can calculate the remaining duration of the icon animation.</p>
</blockquote>
<p>简言之，退出画面回调的时候Icon动画可能进行到了一半，最好计算Icon动画的剩余时长来执行退出动画。</p>
<p>原因在于设备性能会影响App描画的早晚，而第一帧描画的时候上述的退出回调将被执行。也就是说，性能的优劣会影响启动画面退出的回调时机。</p>
<ul>
<li>性能好的话，画面退出的回调较早。此时Icon动画尚在进行当中，可以将Icon动画的预设时长的剩余时间交接给退出效果来执行</li>
<li>性能差的话，画面退出的回调稍晚。Icon动画早已经结束，为了让用户尽早看到画面内容，就不该再执行退出效果了而是直接退出</li>
</ul>
<p><strong>不能为了展示效果而让用户久等，否则会弄巧成拙。</strong></p>
<p>借助SplashScreenView的<code>iconAnimationStartMillis</code>和<code>iconAnimationDurationMillis</code>方法可以推算出Icon动画的剩余时长。</p>
<p>*模拟器上运行的缘故，大部分时候我的Demo在启动画面退出的时候Icon动画都结束了，少部分情况下动画还剩余一点时间，可能实机的情况会不一样。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">showSplashIconExitAnimator</span><span class="params">(splashScreenView: <span class="type">SplashScreenView</span>)</span></span> &#123;</span><br><span class="line">    slideUp.duration = getRemainingDuration(splashScreenView)</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getRemainingDuration</span><span class="params">(splashScreenView: <span class="type">SplashScreenView</span>)</span></span>: <span class="built_in">Long</span>  &#123;</span><br><span class="line">    <span class="comment">// 取得Icon动画的时长</span></span><br><span class="line">    <span class="keyword">val</span> animationDuration = splashScreenView.iconAnimationDurationMillis</span><br><span class="line">    <span class="comment">// 取得Icon动画的开始时刻</span></span><br><span class="line">    <span class="keyword">val</span> animationStart = splashScreenView.iconAnimationStartMillis</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再结合当前时间计算出Icon动画的剩余时长</span></span><br><span class="line">    <span class="comment">// 1. 时长为负则固定为0ms即直接退出</span></span><br><span class="line">    <span class="comment">// 2. 时长为正则采用该时长执行退出动画</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (animationDuration != <span class="literal">null</span> &amp;&amp; animationStart != <span class="literal">null</span>) &#123;</span><br><span class="line">        (animationDuration - SystemClock.uptimeMillis() + animationStart)</span><br><span class="line">        .coerceAtLeast(<span class="number">0</span>L)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="number">0</span>L</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h2 id="4-SplashScreen相关API"><a href="#4-SplashScreen相关API" class="headerlink" title="4 SplashScreen相关API"></a>4 SplashScreen相关API</h2><h3 id="4-1-类和接口"><a href="#4-1-类和接口" class="headerlink" title="4.1 类和接口"></a>4.1 类和接口</h3><table>
<thead>
<tr>
<th>类/接口</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>SplashScreen</td>
<td>启动画面管理接口，通过Activity#getSplashScreen取得</td>
</tr>
<tr>
<td>OnExitAnimationListener</td>
<td>启动画面退出的回调接口，通过SplashScreen#setOnExitAnimationListener注册</td>
</tr>
<tr>
<td>SplashScreenView</td>
<td>启动画面包含的视图，用以定制整体或Icon的退出动画</td>
</tr>
</tbody></table>
<h3 id="4-2-属性"><a href="#4-2-属性" class="headerlink" title="4.2 属性"></a>4.2 属性</h3><table>
<thead>
<tr>
<th>attr</th>
<th>作用</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>splashScreenTheme</td>
<td>指定SplashScreen相关的Style</td>
<td>存在一点问题比如brand图片会不显示</td>
</tr>
<tr>
<td>windowSplashScreenBackground</td>
<td>定制启动画面的背景</td>
<td>默认从windowBackground里读取</td>
</tr>
<tr>
<td>windowSplashScreenBrandingImage</td>
<td>指定启动画面底部的品牌图标</td>
<td>-</td>
</tr>
<tr>
<td>windowSplashScreenAnimatedIcon</td>
<td>指定Icon，支持静态或动画Drawable</td>
<td>-</td>
</tr>
<tr>
<td>windowSplashScreenAnimationDuration</td>
<td>指定动画Icon时长</td>
<td>上限1000ms</td>
</tr>
<tr>
<td>windowSplashScreenIconBackgroundColor</td>
<td>补充Icon背景色</td>
<td>-</td>
</tr>
</tbody></table>
<p>注意：<code>windowSplashscreenContent</code>是8.0版本新增的定制启动画面的属性，自12开始废弃了，使用<code>windowSplashscreenAnimatedIcon</code>替代</p>
<h3 id="4-3-SplashScreen的构成"><a href="#4-3-SplashScreen的构成" class="headerlink" title="4.3 SplashScreen的构成"></a>4.3 SplashScreen的构成</h3><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6579c39d65d54b5bbf34949a8d21e87b~tplv-k3u1fbpfcp-zoom-1.image" alt="构成示意图"></p>
<h2 id="5-注意"><a href="#5-注意" class="headerlink" title="5 注意"></a>5 注意</h2><p>需要尝鲜SplashScreen的话，需要在Android 12上开发，并做如下必要配置。</p>
<ul>
<li>compileSdkVersion和targetSdkVersion声明为<code>S</code></li>
<li><code>android:exported=&quot;true&quot;</code>，明示声明启动画面的可见性，否则会安装失败</li>
</ul>
<p>另外启动页的Icon无论是静态的还是动画效果的，都应遵循<code>Adaptive Icon</code>的规范，不然Icon会发生变形。</p>
<h2 id="6-结语"><a href="#6-结语" class="headerlink" title="6 结语"></a>6 结语</h2><p>Android 12上全新的<code>SplashScreen</code> API非常简单清晰，整个定制过程非常流畅！</p>
<p>相信在全新的API加持下，APP的启动画面可以迸发出更多特色的、好玩的创意。</p>
<p><strong>快快尝试起来，给你的用户留下第一眼的好印象~</strong></p>
<h2 id="本文DEMO"><a href="#本文DEMO" class="headerlink" title="本文DEMO"></a>本文DEMO</h2><p><a href="https://github.com/ellisonchan/SplashScreen" target="_blank" rel="noopener">github.com/ellisonchan…</a></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://blog.csdn.net/jILRvRTrc/article/details/116035700" target="_blank" rel="noopener">欢迎体验 | Android 12 开发者预览版 3</a></p>
<p><a href="https://developer.android.google.cn/about/versions/12/features/splash-screen" target="_blank" rel="noopener">SplashScreen的官方文档</a></p>
<p><a href="https://developer.android.google.cn/reference/android/window/SplashScreen" target="_blank" rel="noopener">SplashScreen API</a></p>
<p><a href="https://developer.android.google.cn/reference/android/R.attr#windowSplashScreenBackground" target="_blank" rel="noopener">SplashScreen相关attr</a></p>
<p>转自TechMerger <a href="https://juejin.cn/post/6962706834889113614" target="_blank" rel="noopener">https://juejin.cn/post/6962706834889113614</a></p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="ZhangMiao 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="ZhangMiao 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    ZhangMiao
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://zhangmiao.cc/posts/8c53fca7.html" title="Android12上全新的应用启动画面">https://zhangmiao.cc/posts/8c53fca7.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Android/" rel="tag"># Android</a>
          
            <a href="/tags/Android-Tips/" rel="tag"># Android Tips</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/posts/24470fc.html" rel="next" title="代码实例展示Java和Kotlin有哪些区别">
                <i class="fa fa-chevron-left"></i> 代码实例展示Java和Kotlin有哪些区别
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/posts/5fd712a2.html" rel="prev" title="GooglePlay新增付款功能一览表">
                GooglePlay新增付款功能一览表 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://avatars0.githubusercontent.com/u/4081078?s=460&v=4" alt="ZhangMiao">
            
              <p class="site-author-name" itemprop="name">ZhangMiao</p>
              <p class="site-description motion-element" itemprop="description">Android/Flutter Developer</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">368</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">58</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">143</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:zm@zhangmiao.cc" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://wpa.qq.com/msgrd?v=3&uin=153942241&site=qq&menu=yes" target="_blank" title="QQ">
                      
                        <i class="fa fa-fw fa-qq"></i>QQ</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/zhangmiaocc" target="_blank" title="Github">
                      
                        <i class="fa fa-fw fa-github"></i>Github</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.constore.cn/" title="Liujianhui" target="_blank">Liujianhui</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://xuebin.me" title="Leo" target="_blank">Leo</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.csdn.net/lmj623565791" title="Hongyang" target="_blank">Hongyang</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://liuwangshu.cn/" title="Liuwangshu" target="_blank">Liuwangshu</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://jspang.com/" title="Jspang" target="_blank">Jspang</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blankj.com/" title="Blankj" target="_blank">Blankj</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://wuxiaolong.me/" title="WuXiaoLong" target="_blank">WuXiaoLong</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://molunerfinn.com" title="Molunerfinn" target="_blank">Molunerfinn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.ofind.cn/" title="Ofind" target="_blank">Ofind</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.gcssloop.com/" title="Gcssloop" target="_blank">Gcssloop</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-前言"><span class="nav-number">1.</span> <span class="nav-text">1 前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-定制进入效果"><span class="nav-number">2.</span> <span class="nav-text">2 定制进入效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-默认的启动效果"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 默认的启动效果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-自定义静态Icon"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 自定义静态Icon</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-自定义Icon背景"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 自定义Icon背景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-自定义品牌Logo"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 自定义品牌Logo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-自定义动画Icon"><span class="nav-number">2.5.</span> <span class="nav-text">2.5 自定义动画Icon</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-延长启动画面"><span class="nav-number">2.6.</span> <span class="nav-text">2.6 延长启动画面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-定制退出效果"><span class="nav-number">3.</span> <span class="nav-text">3 定制退出效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-监听启动画面的退出"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 监听启动画面的退出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-定制整体的退出动画"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 定制整体的退出动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-定制图标的退出动画"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 定制图标的退出动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-退出动画的适当时长"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 退出动画的适当时长</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-SplashScreen相关API"><span class="nav-number">4.</span> <span class="nav-text">4 SplashScreen相关API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-类和接口"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 类和接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-属性"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-SplashScreen的构成"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 SplashScreen的构成</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-注意"><span class="nav-number">5.</span> <span class="nav-text">5 注意</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-结语"><span class="nav-number">6.</span> <span class="nav-text">6 结语</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#本文DEMO"><span class="nav-number">7.</span> <span class="nav-text">本文DEMO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">8.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZhangMiao</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      本站访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








  <div>
    <script type="text/javascript">
      var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
      document.write(unescape("%3Cspan id='cnzz_stat_icon_1277928793'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1277928793%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));
    </script>
  </div>



        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://zhangmiao.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://zhangmiao.cc/posts/8c53fca7.html';
          this.page.identifier = 'posts/8c53fca7.html';
          this.page.title = 'Android12上全新的应用启动画面';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://zhangmiao.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("8iIYW0IGofqyvJiiuU5R9buW-gzGzoHsz", "ssmxRx0kELJir6mA02ziW3Ql");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  


  <script type="text/javascript" src="/lib/zclip/clipboard.min.js"></script>
<script type="text/javascript" src="/js/src/custom.js"></script>

</body>
</html>
